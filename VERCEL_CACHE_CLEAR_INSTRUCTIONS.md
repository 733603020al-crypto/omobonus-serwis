# Инструкции по очистке кэша Vercel и редеплою

## Автоматический способ (через Vercel CLI)

Если Vercel CLI установлен и вы авторизованы:

```powershell
.\clear-vercel-cache.ps1
```

Или вручную:

```powershell
# 1. Авторизация (если еще не авторизованы)
vercel login

# 2. Деплой с принудительной пересборкой
vercel --prod --force
```

## Ручной способ (через Vercel Dashboard)

### Шаг 1: Очистка кэша через Dashboard

1. Откройте https://vercel.com/dashboard
2. Найдите проект **omobonus-serwis** (или **omobonus-serwis-v3**)
3. Перейдите в раздел **Deployments**
4. Найдите **последний деплой** (самый первый в списке)
5. Нажмите на деплой, чтобы открыть детали
6. Нажмите на **три точки (⋮)** в правом верхнем углу
7. Выберите **"Redeploy"**
8. **ВАЖНО:** В открывшемся окне убедитесь, что опция **"Use existing Build Cache"** **ВЫКЛЮЧЕНА** (OFF)
9. Нажмите **"Redeploy"**

### Шаг 2: Альтернативный способ - через Settings

1. Перейдите в **Settings → General**
2. Найдите раздел **"Build & Development Settings"**
3. Временно измените **Build Command** на: `npm run build -- --no-cache`
4. Сохраните изменения
5. Выполните **Redeploy** последнего деплоя
6. После успешного деплоя верните **Build Command** обратно на: `npm run build`

### Шаг 3: Полная очистка через удаление проекта (крайний случай)

⚠️ **Используйте только если другие способы не помогли:**

1. Перейдите в **Settings → General**
2. Прокрутите вниз до раздела **"Danger Zone"**
3. Нажмите **"Remove Project"** (это удалит проект, но не код в GitHub)
4. После удаления создайте проект заново:
   - Нажмите **"Add New Project"**
   - Выберите репозиторий
   - Убедитесь, что выбрана ветка **master**
   - Нажмите **"Deploy"**

## Проверка успешности деплоя

После редеплоя проверьте:

1. **Логи сборки:**
   - Откройте последний деплой
   - Перейдите в **"Build Logs"**
   - Убедитесь, что нет ошибки "No Next.js version detected"
   - Проверьте, что видна строка: `Installing dependencies from package.json`
   - Проверьте, что Next.js установлен: `next@14.2.33`

2. **Статус деплоя:**
   - Должен быть **"Ready"** (зеленый)
   - Не должно быть **"Error"** или **"Build Failed"**

3. **Доступность сайта:**
   - Откройте: https://omobonus-serwis.vercel.app
   - Сайт должен открываться без ошибок
   - Проверьте главную страницу и несколько маршрутов

## Что было сделано локально

✅ Очищен локальный кэш (node_modules, .next, .turbo)  
✅ Выполнена полная переустановка зависимостей  
✅ Обновлен vercel.json с правильной командой установки  
✅ Все изменения закоммичены и запушены в ветку master  
✅ Локальная сборка проверена и работает  

## Следующие шаги

1. Выполните очистку кэша на Vercel (см. инструкции выше)
2. Дождитесь завершения деплоя (обычно 2-5 минут)
3. Проверьте логи сборки на наличие ошибок
4. Проверьте доступность сайта
5. Если ошибка "No Next.js version detected" все еще появляется:
   - Проверьте, что в Vercel Dashboard выбрана ветка **master**
   - Проверьте, что **Root Directory** пуст (не указан путь)
   - Проверьте, что **Framework Preset** установлен как **Next.js**
